"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AppCatalog = exports.App = void 0;
var tslib_1 = require("tslib");
var rest_js_1 = require("../rest.js");
var types_js_1 = require("../webs/types.js");
require("./web.js");
var sharepointqueryable_js_1 = require("../sharepointqueryable.js");
var types_js_2 = require("./types.js");
Object.defineProperty(exports, "App", { enumerable: true, get: function () { return types_js_2.App; } });
Object.defineProperty(exports, "AppCatalog", { enumerable: true, get: function () { return types_js_2.AppCatalog; } });
rest_js_1.SPRest.prototype.getTenantAppCatalogWeb = function () {
    return (0, tslib_1.__awaiter)(this, void 0, void 0, function () {
        var _this = this;
        return (0, tslib_1.__generator)(this, function (_a) {
            return [2 /*return*/, this.childConfigHook(function (_a) {
                    var options = _a.options, runtime = _a.runtime;
                    return (0, tslib_1.__awaiter)(_this, void 0, void 0, function () {
                        var data;
                        return (0, tslib_1.__generator)(this, function (_b) {
                            switch (_b.label) {
                                case 0: return [4 /*yield*/, (0, sharepointqueryable_js_1.SharePointQueryable)("/", "_api/SP_TenantSettings_Current").configure(options).setRuntime(runtime)()];
                                case 1:
                                    data = _b.sent();
                                    if (!(data === null || data === void 0 ? void 0 : data.CorporateCatalogUrl)) {
                                        throw new Error("Failed to get tenant corporate app catalog, its not configured on the tenant.");
                                    }
                                    return [2 /*return*/, (0, types_js_1.Web)(data.CorporateCatalogUrl).configure(options).setRuntime(runtime)];
                            }
                        });
                    });
                })];
        });
    });
};
//# sourceMappingURL=index.js.map