"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BearerTokenFetchClient = void 0;
var common_1 = require("@pnp/common-commonjs");
var fetch_js_1 = require("./fetch.js");
/**
 * Makes requests using the fetch API adding the supplied token to the Authorization header
 */
var BearerTokenFetchClient = /** @class */ (function () {
    function BearerTokenFetchClient(_token) {
        this._token = _token;
    }
    Object.defineProperty(BearerTokenFetchClient.prototype, "token", {
        get: function () {
            return this._token || "";
        },
        set: function (token) {
            this._token = token;
        },
        enumerable: false,
        configurable: true
    });
    BearerTokenFetchClient.prototype.fetch = function (url, options) {
        if (options === void 0) { options = {}; }
        var headers = new Headers();
        (0, common_1.mergeHeaders)(headers, options.headers);
        headers.set("Authorization", "Bearer " + this._token);
        options.headers = headers;
        return (0, fetch_js_1.fetch)(url, options);
    };
    return BearerTokenFetchClient;
}());
exports.BearerTokenFetchClient = BearerTokenFetchClient;
//# sourceMappingURL=bearertokenfetchclient.js.map